@using System.Security.Claims
@model BusSystem.Admin.Web.Models.AdminUserDto
@{
    ViewData["Title"] = "Delete Admin User";
    var currentUserId = User.FindFirst(ClaimTypes.NameIdentifier)?.Value;
    var isDeletingSelf = currentUserId == Model.Id.ToString();
}

<partial name="_BackButton" />

<h1>Delete Admin User</h1>

@if (isDeletingSelf)
{
    <div class="alert alert-danger mt-4" role="alert">
        <h4 class="alert-heading"><i class="bi bi-exclamation-triangle-fill"></i> Warning!</h4>
        <p><strong>You are about to delete your own account!</strong></p>
        <hr>
        <p class="mb-0">Deleting your account will immediately log you out and you will lose access to the admin panel. This action cannot be undone.</p>
    </div>
}
else
{
    <h3 class="text-danger mt-4">Are you sure you want to delete this user?</h3>
}

<div class="mt-3">
    <dl class="row">
        <dt class="col-sm-3">Username</dt>
        <dd class="col-sm-9">@Model.UserName</dd>
        
        <dt class="col-sm-3">Email</dt>
        <dd class="col-sm-9">@Model.Email</dd>
        
        <dt class="col-sm-3">Role</dt>
        <dd class="col-sm-9">@Model.Role</dd>
        
        <dt class="col-sm-3">Created Date</dt>
        <dd class="col-sm-9">@Model.CreatedDate.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
    </dl>
</div>

<form asp-action="Delete" method="post" class="mt-3">
    <input type="hidden" asp-for="Id" />
    @if (isDeletingSelf)
    {
        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you absolutely sure? You will be logged out immediately!');">
            <i class="bi bi-trash"></i> Yes, Delete My Account
        </button>
    }
    else
    {
        <button type="submit" class="btn btn-danger">Delete</button>
    }
    <a asp-action="Index" class="btn btn-secondary">Cancel</a>
</form>
